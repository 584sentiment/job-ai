<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>添加面经 - 求职追踪助手</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tiptap CSS -->
    <style>
        :root {
            --primary: #2563EB;
            --secondary: #3B82F6;
            --cta: #F97316;
            --background: #F8FAFC;
            --text: #1E293B;
            --border: #E2E8F0;
        }
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: var(--background);
            color: var(--text);
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
        }

        /* Tiptap Editor Styles */
        .tiptap-editor {
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .tiptap-editor:focus-within {
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            border-color: var(--primary);
        }
        .tiptap-toolbar {
            background: #F8FAFC;
            border-bottom: 1px solid var(--border);
            padding: 0.5rem;
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
        }
        .tiptap-toolbar button {
            padding: 0.375rem 0.5rem;
            border-radius: 0.375rem;
            color: #475569;
            transition: all 0.2s;
        }
        .tiptap-toolbar button:hover {
            background: #E2E8F0;
        }
        .tiptap-toolbar button.is-active {
            background: var(--primary);
            color: white;
        }
        .tiptap-content {
            padding: 1rem;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            line-height: 1.6;
        }
        .tiptap-content p {
            margin-bottom: 0.5rem;
        }
        .tiptap-content h1, .tiptap-content h2, .tiptap-content h3 {
            font-weight: 600;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            font-family: 'Poppins', sans-serif;
        }
        .tiptap-content h1 { font-size: 1.875rem; }
        .tiptap-content h2 { font-size: 1.5rem; }
        .tiptap-content h3 { font-size: 1.25rem; }
        .tiptap-content ul, .tiptap-content ol {
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .tiptap-content code {
            background: #F1F5F9;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
        }
        .tiptap-content pre {
            background: #1E293B;
            color: #F8FAFC;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 0.5rem;
        }
        .tiptap-content pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }
        .tiptap-content blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin-bottom: 0.5rem;
            color: #64748B;
        }
        .tiptap-content a {
            color: var(--primary);
            text-decoration: underline;
        }
        .tiptap-placeholder {
            color: #94A3B8;
            pointer-events: none;
            position: absolute;
            top: 1rem;
            left: 1rem;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563EB',
                        secondary: '#3B82F6',
                        cta: '#F97316',
                        background: '#F8FAFC',
                        text: '#1E293B',
                        border: '#E2E8F0',
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen pb-20">
    <!-- 顶部导航栏 -->
    <nav class="fixed top-0 left-0 right-0 z-50 glass-card shadow-sm">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <a href="experiences.html" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </a>
                    <h1 class="text-xl font-semibold">添加面经</h1>
                </div>
                <button class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- 主内容区 -->
    <main class="pt-20 px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto">
        <!-- 表单卡片 -->
        <div class="glass-card rounded-xl p-8">
            <form onsubmit="handleSubmit(event)">
                <!-- 关联岗位 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        关联岗位 <span class="text-gray-400">(可选)</span>
                    </label>
                    <select id="jobSelect" onchange="handleJobChange()" class="w-full px-4 py-2.5 rounded-lg border border-border bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200">
                        <option value="">不关联岗位</option>
                        <option value="1">字节跳动 - 前端开发工程师</option>
                        <option value="2">腾讯 - 全栈开发工程师</option>
                        <option value="3">阿里巴巴 - 前端开发工程师</option>
                        <option value="4">美团 - 后端开发工程师</option>
                    </select>
                    <p class="mt-1 text-sm text-gray-500">选择岗位后，公司和岗位名称会自动填充</p>
                </div>

                <!-- 基本信息 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            公司名称 <span class="text-red-500">*</span>
                        </label>
                        <input
                            type="text"
                            id="companyInput"
                            class="w-full px-4 py-2.5 rounded-lg border border-border bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"
                            placeholder="请输入公司名称"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            岗位名称 <span class="text-red-500">*</span>
                        </label>
                        <input
                            type="text"
                            id="positionInput"
                            class="w-full px-4 py-2.5 rounded-lg border border-border bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"
                            placeholder="请输入岗位名称"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            面试轮次 <span class="text-red-500">*</span>
                        </label>
                        <select id="roundSelect" class="w-full px-4 py-2.5 rounded-lg border border-border bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200">
                            <option value="">请选择</option>
                            <option value="笔试">笔试</option>
                            <option value="一面">一面</option>
                            <option value="二面">二面</option>
                            <option value="三面">三面</option>
                            <option value="终面">终面</option>
                            <option value="HR面">HR面</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            面试日期 <span class="text-red-500">*</span>
                        </label>
                        <input
                            type="date"
                            id="dateInput"
                            class="w-full px-4 py-2.5 rounded-lg border border-border bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"
                        >
                    </div>
                </div>

                <!-- 面经内容 - Tiptap编辑器 -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-2">
                        <label class="block text-sm font-medium text-gray-700">
                            面经内容 <span class="text-red-500">*</span>
                        </label>
                        <div class="flex items-center space-x-2">
                            <button
                                type="button"
                                onclick="aiAssist()"
                                class="flex items-center space-x-1 px-3 py-1 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-lg text-sm hover:from-purple-600 hover:to-indigo-600 transition-all duration-200"
                            >
                                <i class="fas fa-magic"></i>
                                <span>AI 辅助</span>
                            </button>
                        </div>
                    </div>

                    <!-- 简易版Tiapap编辑器（基于contenteditable） -->
                    <div class="tiptap-editor">
                        <div class="tiptap-toolbar">
                            <button type="button" onclick="formatDoc('bold')" title="粗体">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" onclick="formatDoc('italic')" title="斜体">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" onclick="formatDoc('formatBlock', 'H2')" title="标题">
                                <i class="fas fa-heading"></i>
                            </button>
                            <div class="w-px h-4 bg-gray-300"></div>
                            <button type="button" onclick="formatDoc('insertUnorderedList')" title="无序列表">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button type="button" onclick="formatDoc('insertOrderedList')" title="有序列表">
                                <i class="fas fa-list-ol"></i>
                            </button>
                            <button type="button" onclick="insertCode()" title="代码块">
                                <i class="fas fa-code"></i>
                            </button>
                            <div class="w-px h-4 bg-gray-300"></div>
                            <button type="button" onclick="formatDoc('createLink')" title="链接">
                                <i class="fas fa-link"></i>
                            </button>
                        </div>
                        <div
                            id="editor"
                            class="tiptap-content"
                            contenteditable="true"
                            data-placeholder="支持富文本编辑，可以添加标题、列表、代码块等..."
                        ></div>
                    </div>

                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-lightbulb text-yellow-500"></i>
                        提示：可使用工具栏格式化内容，或点击"AI辅助"优化文章结构
                    </p>
                </div>

                <!-- 标签 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        标签 <span class="text-gray-400">(可选)</span>
                    </label>
                    <input
                        type="text"
                        id="tagsInput"
                        class="w-full px-4 py-2.5 rounded-lg border border-border bg-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"
                        placeholder="多个标签用空格分隔，例如：Vue3 性能优化 源码"
                    >
                    <p class="mt-1 text-sm text-gray-500">建议添加技术栈、考察重点等标签</p>
                </div>

                <!-- 匿名开关 -->
                <div class="mb-8">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-user-secret text-gray-600"></i>
                            <div>
                                <p class="font-medium text-gray-900">匿名发布</p>
                                <p class="text-sm text-gray-500">开启后，其他用户无法看到你的个人信息</p>
                            </div>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="anonymousCheck" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                        </label>
                    </div>
                </div>

                <!-- 底部操作按钮 -->
                <div class="flex items-center justify-end space-x-4">
                    <a
                        href="experiences.html"
                        class="px-6 py-2.5 rounded-lg border border-border text-gray-700 hover:bg-gray-50 transition-colors duration-200"
                    >
                        取消
                    </a>
                    <button
                        type="submit"
                        class="px-6 py-2.5 bg-primary text-white rounded-lg hover:bg-secondary shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2"
                    >
                        <i class="fas fa-save"></i>
                        <span>保存面经</span>
                    </button>
                </div>
            </form>
        </div>

        <!-- Tiapap 编辑器介绍 -->
        <div class="glass-card rounded-xl p-6 mt-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                <i class="fas fa-robot text-purple-500 mr-2"></i>
                关于 Tiapap 编辑器
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="p-4 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">无头架构</h4>
                    <p class="text-sm text-gray-600">完全控制渲染和样式，适合深度定制</p>
                </div>
                <div class="p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">Vue 3 原生支持</h4>
                    <p class="text-sm text-gray-600">提供 @tiptap/vue-3 包，完美集成 Vue 3</p>
                </div>
                <div class="p-4 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">模块化扩展</h4>
                    <p class="text-sm text-gray-600">丰富的官方扩展，支持Markdown、代码高亮等</p>
                </div>
                <div class="p-4 bg-gradient-to-br from-orange-50 to-amber-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-2">AI 集成友好</h4>
                    <p class="text-sm text-gray-600">可轻松集成 AI 功能，实现智能辅助写作</p>
                </div>
            </div>
            <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                <p class="text-sm text-gray-600">
                    <strong>安装命令：</strong>
                </p>
                <pre class="mt-2 text-sm bg-gray-800 text-gray-100 p-3 rounded-lg overflow-x-auto"><code>npm install @tiptap/vue-3 @tiptap/starter-kit @tiptap/extension-placeholder</code></pre>
            </div>
        </div>
    </main>

    <script>
        // 设置默认日期为今天
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('dateInput').value = today;

        // 岗位改变处理
        function handleJobChange() {
            const select = document.getElementById('jobSelect');
            const option = select.options[select.selectedIndex];

            if (select.value) {
                const [company, position] = option.text.split(' - ');
                document.getElementById('companyInput').value = company;
                document.getElementById('positionInput').value = position;
            } else {
                document.getElementById('companyInput').value = '';
                document.getElementById('positionInput').value = '';
            }
        }

        // 富文本编辑器命令
        function formatDoc(cmd, value = null) {
            if (cmd === 'formatBlock') {
                document.execCommand(cmd, false, value);
            } else if (cmd === 'createLink') {
                const url = prompt('请输入链接地址:');
                if (url) {
                    document.execCommand(cmd, false, url);
                }
            } else {
                document.execCommand(cmd);
            }
            document.getElementById('editor').focus();
        }

        // 插入代码块
        function insertCode() {
            const code = prompt('请输入代码:');
            if (code) {
                const editor = document.getElementById('editor');
                const pre = document.createElement('pre');
                const codeEl = document.createElement('code');
                codeEl.textContent = code;
                pre.appendChild(codeEl);
                editor.appendChild(pre);
            }
        }

        // AI 辅助功能
        function aiAssist() {
            const editor = document.getElementById('editor');

            // 检查是否已有内容
            if (editor.textContent.trim()) {
                if (!confirm('AI辅助将覆盖现有内容，是否继续？')) {
                    return;
                }
            }

            // 模拟AI生成内容
            editor.innerHTML = `
<h2>面试概述</h2>
<p>本次面试主要考察Vue3核心原理和前端工程化能力，面试官非常专业，整体面试体验良好。</p>

<h2>具体问题</h2>

<h3>1. Vue3的响应式原理与Vue2的区别</h3>
<p><strong>Vue2:</strong> 使用 Object.defineProperty 劫持对象属性</p>
<ul>
  <li>无法检测对象属性的新增/删除</li>
  <li>需要递归遍历，性能开销大</li>
</ul>

<p><strong>Vue3:</strong> 使用 Proxy API</p>
<ul>
  <li>可以劫持整个对象，支持13种拦截操作</li>
  <li>懒收集：只有在属性被读取时才进行依赖收集</li>
  <li>使用 WeakMap 优化内存</li>
</ul>

<h3>2. Vue性能优化方案</h3>
<ol>
  <li><strong>路由层面：</strong>路由懒加载</li>
  <li><strong>组件层面：</strong>keep-alive 缓存组件、异步组件</li>
  <li><strong>数据层面：</strong>computed 计算属性缓存、虚拟滚动</li>
  <li><strong>打包层面：</strong>代码分割、Tree Shaking</li>
</ol>

<h3>3. provide/inject 实现原理</h3>
<p>基于依赖注入模式，通过原型链查找依赖，支持响应式传递（使用 reactive/ref）</p>

<h3>4. 手写响应式系统</h3>
<pre><code>function reactive(obj) {
  if (typeof obj !== 'object' || obj === null) {
    return obj
  }

  const proxy = new Proxy(obj, {
    get(target, key, receiver) {
      track(target, key)
      return Reflect.get(target, key, receiver)
    },
    set(target, key, value, receiver) {
      const result = Reflect.set(target, key, value, receiver)
      trigger(target, key)
      return result
    }
  })

  return proxy
}</code></pre>

<h2>面试感受</h2>
<p>面试官很专业，注重底层原理。建议准备时多关注源码阅读和设计思想。</p>

<h2>后续安排</h2>
<p>面试结束后3个工作日内会通知结果，通过的话会安排二面。</p>
`;

            alert('AI已生成面经内容模板，你可以继续编辑完善！');
        }

        // 表单提交
        function handleSubmit(event) {
            event.preventDefault();

            const company = document.getElementById('companyInput').value;
            const position = document.getElementById('positionInput').value;
            const round = document.getElementById('roundSelect').value;
            const date = document.getElementById('dateInput').value;
            const content = document.getElementById('editor').innerHTML;
            const tags = document.getElementById('tagsInput').value;

            // 表单验证
            if (!company || !position || !round || !date) {
                alert('请填写所有必填项');
                return;
            }

            if (!document.getElementById('editor').textContent.trim()) {
                alert('请填写面经内容');
                return;
            }

            // 模拟保存
            alert('面经保存成功！即将返回列表页...');
            window.location.href = 'experiences.html';
        }

        // Placeholder 处理
        const editor = document.getElementById('editor');
        editor.addEventListener('focus', function() {
            if (this.textContent === '') {
                this.removeAttribute('data-placeholder');
            }
        });
        editor.addEventListener('blur', function() {
            if (this.textContent === '') {
                this.setAttribute('data-placeholder', this.getAttribute('data-placeholder'));
            }
        });
    </script>
</body>
</html>
