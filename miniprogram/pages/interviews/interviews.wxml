<!--pages/interviews/interviews.wxml-->
<view class="container">
  <scroll-view class="main-content" scroll-y scroll-with-animation>
    <!-- Tabåˆ‡æ¢ -->
    <view class="tabs">
      <view
        class="tab-item {{currentTab === 'upcoming' ? 'active' : ''}}"
        bindtap="onTabChange"
        data-tab="upcoming"
      >
        <text class="tab-text">å³å°†åˆ°æ¥</text>
        <text class="tab-count">({{upcomingCount}})</text>
      </view>
      <view
        class="tab-item {{currentTab === 'completed' ? 'active' : ''}}"
        bindtap="onTabChange"
        data-tab="completed"
      >
        <text class="tab-text">å·²å®Œæˆ</text>
        <text class="tab-count">({{completedCount}})</text>
      </view>
    </view>

    <!-- AIå‡†å¤‡æ¸…å•å¡ç‰‡ -->
    <view class="ai-card" wx:if="{{currentTab === 'upcoming' && nextInterview}}">
      <view class="ai-header">
        <view class="ai-title-row">
          <text class="ai-icon">â°</text>
          <text class="ai-title">é¢è¯•å€’è®¡æ—¶ï¼š{{nextInterview.relativeTime}}</text>
        </view>
        <view class="priority-badge">é«˜ä¼˜å…ˆçº§</view>
      </view>

      <view class="interview-info">
        <text class="interview-company">{{nextInterview.company}}</text>
        <text class="interview-position">{{nextInterview.position}}ï¼ˆ{{nextInterview.round}}ï¼‰</text>
      </view>

      <!-- AIå‡†å¤‡æ¸…å• -->
      <view class="prep-list" wx:if="{{nextInterview.aiPrepList && nextInterview.aiPrepList.length > 0}}">
        <view class="prep-title">ğŸ“‹ AIå‡†å¤‡æ¸…å•</view>
        <view class="prep-items">
          <label
            class="prep-item"
            wx:for="{{nextInterview.aiPrepList}}"
            wx:key="id"
            bindtap="togglePrepItem"
            data-id="{{item.id}}"
          >
            <checkbox class="prep-checkbox" checked="{{item.completed}}" />
            <text class="prep-text {{item.completed ? 'completed' : ''}}">{{item.text}}</text>
          </label>
        </view>
      </view>

      <button class="ai-action-btn" bindtap="startMockInterview">
        <text>ğŸ’¬</text>
        <text>å¼€å§‹æ¨¡æ‹Ÿé¢è¯•</text>
      </button>
    </view>

    <!-- é¢è¯•åˆ—è¡¨ -->
    <view class="interview-list">
      <block wx:if="{{interviews.length > 0}}">
        <view
          class="interview-card card"
          wx:for="{{interviews}}"
          wx:key="id"
          bindtap="onInterviewTap"
          data-id="{{item.id}}"
        >
          <view class="interview-header">
            <view class="interview-company-info">
              <text class="interview-company">{{item.company}}</text>
              <text class="interview-position">{{item.position}} - {{item.round}}</text>
            </view>
            <view class="status-badge status-{{item.status}}">
              {{item.statusText}}
            </view>
          </view>

          <view class="interview-meta">
            <view class="meta-item">
              <text class="meta-icon">ğŸ“…</text>
              <text class="meta-text">{{item.date}}</text>
            </view>
            <view class="meta-item">
              <text class="meta-icon">â°</text>
              <text class="meta-text">{{item.time}}</text>
            </view>
            <view class="meta-item">
              <text class="meta-icon">ğŸ“</text>
              <text class="meta-text">{{item.location}}</text>
            </view>
          </view>
        </view>
      </block>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:else>
        <text class="empty-icon">ğŸ“…</text>
        <text class="empty-text">{{currentTab === 'upcoming' ? 'æš‚æ— å³å°†åˆ°æ¥çš„é¢è¯•' : 'æš‚æ— å·²å®Œæˆçš„é¢è¯•'}}</text>
      </view>
    </view>
  </scroll-view>
</view>
