<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-content">
      <text class="page-title">æˆ‘çš„å²—ä½</text>
      <view class="header-actions">
        <image class="avatar-icon" src="{{userProfile.avatar}}" />
      </view>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒº -->
  <view class="main-content">
    <!-- æœç´¢æ¡† -->
    <view class="search-box">
      <image class="search-icon" src="/assets/icons/search.png" />
      <input class="search-input" placeholder="æœç´¢å…¬å¸æˆ–å²—ä½åç§°..." value="{{searchKeyword}}" bindinput="onSearchInput"
        adjust-position="{{false}}" />
    </view>

    <!-- AIæ™ºèƒ½åˆ†æå¡ç‰‡ -->
    <view class="ai-card">
      <view class="ai-header">
        <text class="ai-icon">ğŸ¤–</text>
        <text class="ai-title">AI æ™ºèƒ½åˆ†æ</text>
      </view>
      <view class="ai-content">
        <text class="ai-text">ä½ æœ‰ <text class="ai-highlight">{{interviewCount}}</text> ä¸ªå²—ä½è¿›å…¥é¢è¯•é˜¶æ®µ</text>
      </view>
      <view class="ai-stats">
        <text class="ai-stat-icon">ğŸ“Š</text>
        <text class="ai-stat-text">æœ¬å‘¨æ•°æ®åˆ†æï¼šæŠ•é€’ {{jobs.length}} ä¸ª | é¢è¯• {{interviewCount}} åœº</text>
      </view>
    </view>

    <!-- ç­›é€‰æ ‡ç­¾ -->
    <scroll-view class="filter-tags" scroll-x enable-flex>
      <view class="filter-tag {{currentFilter === 'all' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="all">
        å…¨éƒ¨
      </view>
      <view class="filter-tag {{currentFilter === 'pending' ? 'active' : ''}}" bindtap="onFilterChange"
        data-filter="pending">
        å¾…æŠ•é€’
      </view>
      <view class="filter-tag {{currentFilter === 'applied' ? 'active' : ''}}" bindtap="onFilterChange"
        data-filter="applied">
        å·²æŠ•é€’
      </view>
      <view class="filter-tag {{currentFilter === 'interview' ? 'active' : ''}}" bindtap="onFilterChange"
        data-filter="interview">
        é¢è¯•ä¸­
      </view>
      <view class="filter-tag {{currentFilter === 'offered' ? 'active' : ''}}" bindtap="onFilterChange"
        data-filter="offered">
        å·²å½•ç”¨
      </view>
    </scroll-view>

    <!-- å²—ä½åˆ—è¡¨ -->
    <view class="jobs-list">
      <block wx:if="{{jobs.length > 0}}">
        <view class="job-card card clickable" wx:for="{{jobs}}" wx:key="id" bindtap="onJobTap" data-id="{{item.id}}">
          <view class="job-header">
            <view class="company-info">
              <view class="company-logo" style="background: {{item.logoColor}}">{{item.logoText}}</view>
              <view class="company-details">
                <text class="company-name">{{item.company}}</text>
                <text class="position-name">{{item.position}}</text>
              </view>
            </view>
            <view class="status-badge status-{{item.status}}">{{item.statusText}}</view>
          </view>

          <view class="job-meta">
            <view class="meta-item">
              <image class="meta-icon" src="/assets/icons/location.png" />
              <text class="meta-text">{{item.location}}</text>
            </view>
            <view class="meta-item">
              <image class="meta-icon" src="/assets/icons/salary.png" />
              <text class="meta-text">{{item.salary}}</text>
            </view>
            <view class="meta-item">
              <image class="meta-icon" src="/assets/icons/calendar.png" />
              <text class="meta-text">{{item.applyDate}}</text>
            </view>
          </view>

          <view class="job-progress" wx:if="{{item.aiMatchScore}}">
            <view class="progress-header">
              <text class="progress-label">AIåŒ¹é…åº¦</text>
              <text class="progress-value">{{item.aiMatchScore.overall}}%</text>
            </view>
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.aiMatchScore.overall}}%"></view>
            </view>
          </view>
        </view>

        <!-- åŠ è½½æ›´å¤šæç¤º -->
        <view class="load-more" wx:if="{{hasMore}}">
          <text class="loading-text" wx:if="{{loading}}">åŠ è½½ä¸­...</text>
          <text class="loading-text" wx:else>ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
        </view>
        <view class="load-more" wx:else>
          <text class="loading-text">æ²¡æœ‰æ›´å¤šäº†</text>
        </view>
      </block>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:else>
        <image class="empty-icon" src="/assets/icons/empty.png" />
        <text class="empty-text">æš‚æ— å²—ä½æ•°æ®</text>
        <text class="empty-hint">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®æ·»åŠ æ–°å²—ä½</text>
      </view>
    </view>
  </view>

  <!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="onAddJob">
    <image class="fab-icon" src="/assets/icons/add-white.png" />
  </view>
</view>