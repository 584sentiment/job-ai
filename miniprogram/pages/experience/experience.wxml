<!--pages/experience/experience.wxml-->
<view class="container">
  <view class="main-content">
    <!-- æœç´¢æ¡† -->
    <view class="search-box">
      <image class="search-icon" src="/assets/icons/search.png" />
      <input
        class="search-input"
        placeholder="æœç´¢å…¬å¸æˆ–å²—ä½..."
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
    </view>

    <!-- Tabåˆ‡æ¢ -->
    <view class="tabs">
      <view
        class="tab-item {{currentTab === 'all' ? 'active' : ''}}"
        bindtap="onTabChange"
        data-tab="all"
      >
        <text class="tab-text">å…¨éƒ¨</text>
        <text class="tab-count">({{totalCount}})</text>
      </view>
      <view
        class="tab-item {{currentTab === 'favorite' ? 'active' : ''}}"
        bindtap="onTabChange"
        data-tab="favorite"
      >
        <text class="tab-text">æˆ‘çš„æ”¶è—</text>
        <text class="tab-count">({{favoriteCount}})</text>
      </view>
    </view>

    <!-- é¢ç»åˆ—è¡¨ -->
    <view class="experiences-list">
      <block wx:if="{{experiences.length > 0}}">
        <view
          class="experience-card card clickable"
          wx:for="{{experiences}}"
          wx:key="id"
          bindtap="onExperienceTap"
          data-id="{{item.id}}"
        >
          <view class="exp-header">
            <view class="company-info">
              <text class="company-name">{{item.company}}</text>
              <text class="position-name">{{item.position}}</text>
            </view>
            <view class="exp-meta">
              <text class="exp-date">{{item.dateText}}</text>
              <text class="exp-round">{{item.statusText}}</text>
            </view>
          </view>

          <!-- å…³è”å²—ä½ -->
          <view class="related-job" wx:if="{{item.jobId}}">
            <text class="related-label">å…³è”ï¼š</text>
            <text class="related-text">{{item.company}} - {{item.position}}</text>
          </view>

          <!-- é¢ç»å†…å®¹é¢„è§ˆ -->
          <view class="exp-preview">
            <text class="exp-content">{{item.content}}</text>
            <text class="exp-ellipsis" wx:if="{{item.content.length > 100}}">...</text>
          </view>

          <!-- æ ‡ç­¾ -->
          <view class="tags" wx:if="{{item.tagsArray.length > 0}}">
            <view class="tag" wx:for="{{item.tagsArray}}" wx:for-item="tag" wx:key="*this">
              {{tag}}
            </view>
          </view>

          <!-- åº•éƒ¨æ“ä½œ -->
          <view class="exp-footer">
            <text class="exp-date">{{item.date}}</text>
            <text class="exp-time">{{item.dateText}}</text>
          </view>
        </view>
      </block>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:else>
        <text class="empty-icon">ğŸ“–</text>
        <text class="empty-text">æš‚æ— é¢ç»è®°å½•</text>
        <text class="empty-hint">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®æ·»åŠ ç¬¬ä¸€ç¯‡é¢ç»</text>
      </view>
    </view>
  </view>

  <!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="onAddExperience">
    <image class="fab-icon" src="/assets/icons/add-white.png" />
  </view>
</view>
